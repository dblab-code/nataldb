<!DOCTYPE html>
<html>
  <head>
    <title>DBServer</title>
  </head>
  <script src="https://aframe.io/releases/0.8.2/aframe.min.js"></script>
  <script src="https://raw.githack.com/jeromeetienne/AR.js/master/aframe/build/aframe-ar.min.js"></script>
  <script src="https://rawgit.com/donmccurdy/aframe-extras/master/dist/aframe-extras.loaders.min.js"></script>
  <body style="margin : 0px; overflow: hidden;">
    <a-scene
      embedded
      arjs="debugUIEnabled: false; patternRatio: 0.7;"
      vr-mode-ui="enabled: false"
      light="defaultLightsEnabled: true"
    >
      <a-assets>
        <a-asset-item
          id="tree-obj"
          src="https://cdn.glitch.com/008c284a-f4ae-491a-aae4-1de537fa7849%2Fcenario_TodoAzul_chaoCircular.obj?v=1576070509396"
        ></a-asset-item>
        <audio
          id="sound"
          src="https://cdn.glitch.com/008c284a-f4ae-491a-aae4-1de537fa7849%2Fjingle-bell-rock.mp3?v=1576070111349"
          preload="auto"
        ></audio>
        <a-asset-item
          id="tree-mtl"
          src="https://cdn.glitch.com/008c284a-f4ae-491a-aae4-1de537fa7849%2Fcenario_TodoAzul_chaoCircular.mtl?v=1576070506600"
        ></a-asset-item>
        <a-asset-item
          id="db-mtl"
          src="https://cdn.glitch.com/008c284a-f4ae-491a-aae4-1de537fa7849%2FlogoDB_60graus.mtl?v=1576095223741"
        ></a-asset-item>
        <a-asset-item
          id="db-obj"
          src="https://cdn.glitch.com/008c284a-f4ae-491a-aae4-1de537fa7849%2FlogoDB_60graus.obj?v=1576095224203"
        ></a-asset-item>
      </a-assets>
      <a-marker
        type="pattern"
        url="https://raw.githubusercontent.com/larissayasin/nataldb/master/markers/pattern-natal_DB-07.patt"
      >
        <!--               <a-marker preset="kanji"> -->
        <a-obj-model
          src="#tree-obj"
          mtl="#tree-mtl"
          sound="src: #sound; autoplay: false"
          soundhandler
        ></a-obj-model>
        <a-obj-model src="#db-obj" mtl="#db-mtl" position="0 1.7 0">
          <a-animation
            attribute="rotation"
            dur="6000"
            to="0 360 0"
            repeat="indefinite"
          ></a-animation
        ></a-obj-model>
        <a-sphere color="white" radius="0.015">
          <a-animation
            attribute="position"
            dur=" 5000"
            from=" 0 1.8 0"
            to=" 0 0 0"
            repeat="indefinite"
            easing="linear"
            delay="1000"
          ></a-animation>
        </a-sphere>

        <a-sphere color="white" radius="0.015">
          <a-animation
            attribute="position"
            dur=" 3000"
            from=" 0.35 1.8 0"
            to=" 0.35 0 0"
            repeat="indefinite"
            easing="linear"
            delay="900"
          ></a-animation>
        </a-sphere>

        <a-sphere color="white" radius="0.015">
          <a-animation
            attribute="position"
            dur=" 5000"
            from=" 0.25 1.8 0"
            to=" 0.25 0 0"
            repeat="indefinite"
            easing="linear"
            delay="0"
          ></a-animation>
        </a-sphere>

        <a-sphere color="white" radius="0.015">
          <a-animation
            attribute="position"
            dur=" 5000"
            from=" 0.0 1.8 -0.5"
            to=" 0 0 -0.5"
            repeat="indefinite"
            easing="linear"
            delay="1200"
          ></a-animation>
        </a-sphere>

        <a-sphere color="white" radius="0.015">
          <a-animation
            attribute="position"
            dur=" 5000"
            from="-0.15 1.8 0.5"
            to="-0.15 0 0.5"
            repeat="indefinite"
            easing="linear"
            delay="800"
          ></a-animation>
        </a-sphere>

        <a-sphere color="white" radius="0.015">
          <a-animation
            attribute="position"
            dur=" 5000"
            from="0 1.8 0.25"
            to="0 0 0.25"
            repeat="indefinite"
            easing="linear"
            delay="2000"
          ></a-animation>
        </a-sphere>

        <a-sphere color="white" radius="0.015">
          <a-animation
            attribute="position"
            dur=" 5000"
            from="0.25 1.8 -0.25"
            to="0.25 0 -0.25"
            repeat="indefinite"
            easing="linear"
            delay="100"
          ></a-animation>
        </a-sphere>

        <a-sphere color="white" radius="0.015">
          <a-animation
            attribute="position"
            dur=" 5000"
            from="-0.25 1.8 -0.25"
            to="-0.25 0 -0.25"
            repeat="indefinite"
            easing="linear"
            delay="3000"
          ></a-animation>
        </a-sphere>

        <a-sphere color="white" radius="0.015">
          <a-animation
            attribute="position"
            dur=" 5000"
            from="0 1.8 -0.25"
            to=" 0 0 -0.25"
            repeat="indefinite"
            easing="linear"
            delay="1000"
          ></a-animation>
        </a-sphere>

        <a-sphere color="white" radius="0.015">
          <a-animation
            attribute="position"
            dur=" 5000"
            from="0.25 1.8 0.25"
            to="0.25 0 0.25"
            repeat="indefinite"
            easing="linear"
            delay="1300"
          ></a-animation>
        </a-sphere>
      </a-marker>
      <!--       <a-entity sound="src: #sound" autoplay="true"></a-entity> -->
      <a-entity camera></a-entity>
    </a-scene>
    <script>
      AFRAME.registerComponent("soundhandler", {
        tick: function() {
          var entity = document.querySelector("[sound]");
          if (document.querySelector("a-marker").object3D.visible == true) {
            entity.components.sound.playSound();
            console.log("play");
          } else {
            entity.components.sound.pauseSound();
            console.log("pause");
          }
        }
      });
    </script>
  </body>
</html>
